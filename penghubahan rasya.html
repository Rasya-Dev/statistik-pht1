<script>
    // ... (kode sebelumnya tetap sama)

    // Function to get category based on value
    function getCategory(criteria, value) {
        // Special case for Muhammad Rasya Annabil
        if (selectedName.textContent === "MUHAMMAD RASYA ANNABIL 🤫🧏‍♂️") {
            const specialCategories = {
                attendance: '<span class="excellent">EZ LOL</span>',
                assignments: '<span class="bad">OMAGAAA!?!</span>',
                discipline: '<span class="excellent">PAKE NANYA</span>',
                understanding: '<span class="bad">-99999</span>',
                grades: '<span class="good">∞</span>',
                activity: '<span class="medium">ML NO #1🔥🔥</span>'
            };
            return specialCategories[criteria];
        }

        // Normal category calculation for other students
        if (typeof value !== 'number') return '-';
        if (value < 40) return '<span class="bad">DONGOO</span>';
        if (value < 70) return '<span class="medium">SALAM BOOYAH</span>';
        if (value < 90) return '<span class="good">ALBERT EINSTEIN</span>';
        return '<span class="excellent">MAHKOTA MU KETINGGALAN KING 👑</span>';
    }

    // Event listener for select change
    studentSelect.addEventListener('change', function() {
        const selectedStudent = this.value;
        
        if (selectedStudent) {
            selectedName.textContent = selectedStudent;
            
            const stats = studentData[selectedStudent];
            const values = [
                stats.attendance,
                stats.assignments,
                stats.discipline,
                stats.understanding,
                stats.grades,
                stats.activity
            ];
            
            // Update radar chart
            radarChart.data.datasets[0].data = values.map(val => typeof val === 'number' ? val : 0);
            radarChart.update();
            
            // Update table values
            document.getElementById('attendanceValue').textContent = stats.attendance;
            document.getElementById('assignmentsValue').textContent = stats.assignments;
            document.getElementById('disciplineValue').textContent = stats.discipline;
            document.getElementById('understandingValue').textContent = stats.understanding;
            document.getElementById('gradesValue').textContent = stats.grades;
            document.getElementById('activityValue').textContent = stats.activity;
            
            // Update categories with colors - now passing criteria name
            document.getElementById('attendanceCategory').innerHTML = getCategory('attendance', stats.attendance);
            document.getElementById('assignmentsCategory').innerHTML = getCategory('assignments', stats.assignments);
            document.getElementById('disciplineCategory').innerHTML = getCategory('discipline', stats.discipline);
            document.getElementById('understandingCategory').innerHTML = getCategory('understanding', stats.understanding);
            document.getElementById('gradesCategory').innerHTML = getCategory('grades', stats.grades);
            document.getElementById('activityCategory').innerHTML = getCategory('activity', stats.activity);
        } else {
            selectedName.textContent = '';
            
            // Reset chart
            radarChart.data.datasets[0].data = [0, 0, 0, 0, 0, 0];
            radarChart.update();
            
            // Reset table
            const valueCells = document.querySelectorAll('.stats-table td:nth-child(2)');
            const categoryCells = document.querySelectorAll('.stats-table td:nth-child(3)');
            
            valueCells.forEach(cell => cell.textContent = '-');
            categoryCells.forEach(cell => cell.textContent = '-');
        }
    });
</script>
